
\begin{definition}\label{def:Dyck_paths}
  A Dyck path of length $k$ is a sequence $(d_1,...,d_k) \in \{\pm 1\}^k$ such that their partial sum $\sum_{i=1}^j d_i \geq 0$
  and total sum $\sum_{i = 1}^{k}d_i = 0$. More intuitively, consider a diagonal lattice path from $(0,0)$ to $(k, 0)$ consisting of
  $\frac{k}{2}$ ups and $\frac{k}{2}$ downs such that the path never goes below thw $x$-axis.
\end{definition}


\begin{definition}\label{def:graph_to_Dyck_map}
   Define a map $\phi$ whose input is $(G, w) \in \mathcal{G}^{k/2 + 1}_k$. Then for its output,
   define a sequence $\mathbf{d}=\mathbf{d}(G,w)\in\{+1,-1\}^k$ recursively as follows.
   Let $d_1=+1$.  For $1<j\le k$, if $w_j\notin\{w_1,\ldots,w_{j-1}\}$, set $d_j=+1$; otherwise, set $d_j=-1$; then
   $\mathbf{d}(G,w) = (d_1,\ldots,d_k)$. $\phi((G,w)) = \mathbf{d}(G,w)$
\end{definition}


\begin{lemma}\label{lem:graph_Dyck_correspondence}
  \uses{def:Dyck_paths, def:graph_to_Dyck_map}
  $\phi((G,w)) = \mathbf{d}(G,w) \subseteq \mathcal{D}_k$, where $\mathcal{D}_k$ denotes the set of Dyck path of order $k$.
  \begin{proof}
    set $P_0 = (0,0)$ and $P_j = (j,d_1+\cdots+d_j)$ for $1\le j\le k$; then the piecewise linear path
    connecting $P_0,P_1,\ldots,P_k$ is a lattice path.  Since $(G,w)\in\mathcal{G}_k^2$, each edge appears exactly two times in $w$,
    meaning that the $\pm1$s come in pairs in $\mathbf{d}(G,w)$.  Hence $d_1+\cdots+d_k=0$.  What's more, for any edge $e$,
    the $-1$ assigned to its second appearance in $w$ comes {\em after} the $+1$ corresponding to its first appearance;
    this means that the partial sums $d_1+\cdots+d_j$ are all $\ge 0$.  That is: $\mathbf{d}(G,w)$ is a Dyck path
  \end{proof}
\end{lemma}


\begin{definition}\label{def:Dyck_to_graph_map}
   Define a map $\psi$ whose input is a Dyck path of order $k$: $\mathbf{d} \in \{\pm1\}^k$. Then the output is viewing
  this Dyck path as a contour reversal of a tree where an up ($d_i = 1$) corresponds to visiting a child node
  and a down ($d_i = -1$) corresponds to returning to parent node.
\end{definition}


\begin{lemma}\label{lem:Dyck_graph_correspondence}
  \uses{def:Dyck_paths, def:Dyck_to_graph_map}
  $\psi(\mathbf{d}_k) \subseteq \mathcal{G}^{k/2 + 1}_k$
  \begin{proof}
    Use induction on the order of Dyck path $k$ which is an even number. Assume $\phi(\mathbf{d}_{k-2})
    \subseteq \mathcal{G}_{k-2}^{k/2 -1}$. In the case of $k$, the last two steps appended to $\mathbf{d}_{k-2}$
    has to be $1$ followed by $-1$ in order for $\mathbf{d}_k$ to be a Dyck path. By induction hypothesis,
    this generates a graph with one extra vertex from the parent node, whose walk traversed at the last two steps of the walk.
  \end{proof}
\end{lemma}


\begin{lemma}\label{lem:composition1}
  \uses{def:Dyck_to_graph_map, def:graph_to_Dyck_map, lem:Dyck_graph_correspondence}
  $$\phi \circ \psi = id_{\mathcal{D}_k}$$
  \begin{proof}
    \uses{def:Dyck_to_graph_map, def:graph_to_Dyck_map}
    % \leanok
    Apply $\psi$ to a given Dyck path $\mathbf{d}$ by definition, then apply $\phi$ to get a new sequence
    $\mathbf{d}'$ such that $d_j' = 1$ for new vertex, $-1$ otherwise. For the original Dyck path, the new
    vertex is the up step corresponding to $1$. This implies $\phi$ recovers the original Dyck path.
  \end{proof}
\end{lemma}


\begin{lemma}\label{lem:composition2}
  \uses{def:Dyck_to_graph_map, def:graph_to_Dyck_map, lem:graph_Dyck_correspondence}
  $$\psi \circ \phi = id_{\mathcal{G}^{k/2 + 1}_k}$$
   \begin{proof}
    \uses{def:Dyck_to_graph_map, def:graph_to_Dyck_map}
    % \leanok
    The map $\psi$ recovers the graph walk structure of the input from its Dyck path by the definition.
  \end{proof}
\end{lemma}


\begin{lemma}\label{lem:walk_to_Dyck_paths_bijection}
  \uses{lem:composition1, lem:composition2}
  Let $k$ be even and let $\mathcal{D}_k$ denote the set of Dyck paths of length $k$
  \[ \mathcal{D}_k = \{(d_1,\ldots,d_k)\in\{\pm 1\}\colon \sum_{i=1}^k d_i\ge 0\text{ for }1\le j\le j\text{, and}\sum_{i=1}^kd_i=0\}. \]
  Then $(G,w)\mapsto {d}(G,w)$ is a bijection $\mathcal{G}_k^{k/2+1}\to\mathcal{D}_k$.
  \begin{proof}
    \uses{}
    obvious from the previous lemmas.
  \end{proof}
\end{lemma}

\begin{definition}\label{def:Catalan_number}
  %\lean{Combinatorics.Enumerative.Catalan}
  \[C_0 = 1, \quad \text{and for } n \geq 1, \quad C_n = \sum_{k=0}^{n-1} C_k C_{n-1-k}.\]
\end{definition}


\begin{lemma}\label{lem:binary_tree_Catalan_number}
  \uses{def:Catalan_number}
  \#\{binary trees with $k$ vertices\} is given by Catalan number $C_k$
  \begin{proof}
  \end{proof}
\end{lemma}


\begin{proposition}\label{prop:Catalan_Dyck_samecardinality}
  \uses{def:Catalan_number, def:Dyck_paths, lem:binary_tree_Catalan_number}
  %\lean{Catalan}
  % \uses{}
  %\lean{Mathlib.Combinatorics.Enumerative.Catalan}
  %\lean{DyckWord.card_dyckWord_semilength_eq_catalan}
  \[|\mathcal{D}_k| = C_{k/2} \] where $|\mathcal{D}_k|$ denotes the number of Dyke paths of length $k$ while
  $C_k$ is the $k$th Catalan number.
  \begin{proof}
    Given a binary tree with $k$ nodes, perform preorder traversal: for each internal node visited, write
    an up-step \(U = (1,1)\). For each time return from a child, write a down-step \(D = (1,-1)\).
    Since every internal node has exactly two children, there are \(k/2\) \(U\)'s and \(k/2\) \(D\)'s,
    giving a Dyke path of length \(k\). Conversely, given a Dyck path, $U$ is interpreted as adding new node
    while $D$ is returning to the parent node.
  \end{proof}
\end{proposition}

\begin{proposition}\label{graph_Catalan_number}
  \uses{prop:Catalan_Dyck_samecardinality, lem:walk_to_Dyck_paths_bijection}
  \[|\mathcal{G}^{k/2 + 1}_k| = C_{k/2}\]
\end{proposition}








\iffalse

two extra definitions for dyck path to graph
and graph to dyck path

then a lemma: showing that these two give identity


\begin{proposition}[Proposition 4.1 in \cite{Kemp2013RMTNotes}]
  \label{prop:matrix_moments_convergence}
  \notready
  %\uses{def:}
  Let $\{Y_{ij}\}_{1\le i\le j}$ be independent random variables, with $\{Y_{ii}\}_{i\ge 1}$ identically distributed and $\{Y_{ij}\}_{1\le i<j}$ identically distributed.  Suppose that $r_k = \max\{\bE(|Y_{11}|^k),\bE(|Y_{12}|^k)\} <\infty$ for each $k\in\bN$.  Suppose further than $\bE(Y_{ij})=0$ for all $i,j$ and set $t=\bE(Y_{12}^2)$.  If $i>j$, define $Y_{ij} \equiv Y_{ji}$, and let $\mathbf{Y}_n$ be the $n\times n$ matrix with $[\mathbf{Y}_n]_{ij} = Y_{ij}$ for $1\le i,j\le n$.  Let $\mathbf{X}_n = n^{-1/2}\mathbf{Y}_n$ be the corresponding Wigner matrix.  Then
\[
\lim_{n\to\infty} \frac{1}{n}\bE\Tr(\mathbf{X}_n^k) = \begin{cases}
  t^{k/2}C_{k/2}, & k\text{ even} \\
  0, & k\text{ odd}
\end{cases}.
\]
\end{proposition}

\begin{proof}
\notready
Proof
\end{proof}

\begin{lemma}
  \uses{lem:composition1, lem:composition2}
  Let $k$ be even and let $\mathcal{D}_k$ denote the set of Dyck paths of length $k$
  \[ \mathcal{D}_k = \{(d_1,\ldots,d_k)\in\{\pm 1\}\colon \sum_{i=1}^k d_i\ge 0\text{ for }1\le j\le j\text{, and}\sum_{i=1}^kd_i=0\}. \]
  Then $(G,w)\mapsto {d}(G,w)$ is a bijection $\mathcal{G}_k^{k/2+1}\to\mathcal{D}_k$.
  \begin{proof}
    \uses{}
    For $(G,w)\in\mathcal{G}_k^{k/2+1}$, the above discussion shows that $\mathbf{d}(G,w)\in\mathcal{D}_k$. We
    construct an inverse to this map. For any $(d_1,...,d_k) \in \mathcal{D}_k$, view it as a contour
    reversal of a tree where an up ($d_i = 1$) corresponds to visiting a child node and a down ($d_i = -1$) corresponds
    to returning to parent node. This gives a tree graph $G$ with $k/2 + 1$ vertices (including the starting node) and the
    sequence of vertices visited is a closed walk with each vertex traversed twice to return to the top most vertex.
  \end{proof}
\end{lemma}

\begin{lemma}\label{lem:trace_smul}
  %\uses{????}
  \mathlibok %what does this mean
  \lean{Matrix.trace_smul}
  Let $R$ be a ring with a monoid action from $\alpha$ (i.e., $\alpha$ acts distributively on $R$).
  For any scalar $r \in \alpha$ and any square matrix $A$ over $R$, the trace of the scalar
  multiple $r \cdot A$ equals the scalar multiple of the trace of $A$, i.e.,
  \[ \text{tr}(r \cdot A) = r \cdot \text{tr}(A). \]
  \end{lemma}

  \begin{proof}\leanok %what does this mean
  %idk what to put in here
  \end{proof}


% 4.2
% lemma (lemma1): using Matrix.mul_apply?? + induction?


% definition of trace
% linearity of expectation --> map_expect????
% lemma1
% defn of Y_i, [n].


% define a graph (no idea how to do this in lean)

% matrices commutative? don't really understand this part of the proof

%define \omega ({i, j})
% 4.3's statement

% 4.4: true because multiplication is commutative (EReal.mul_comm)


% more graph definitions (idk how lean would work)


% smt smt get to 4.5

% 4.6: use 4.5, scalar multiple of expectatio (Finset.smul_expect), trace of scalar multiple (Matrix.trace_smul)


% lemma 4.3: lots more work needed

%4.7: use lemma 4.3

% w >= 2 stuff
% 4.8

% 4.3.1: maybe SimpleGraph.IsTree.card_edgeFinset??

% test edit by Richard
%% test edit 2 by Richard

\fi
