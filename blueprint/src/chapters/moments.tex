\begin{proposition}%[Proposition 4.1 in \cite{Kemp2013RMTNotes}]
  \label{prop:matrix_moments_convergence}
  \notready
  %\uses{}
  Let $\{Y_{ij}\}_{1\le i\le j}$ be independent random variables, with $\{Y_{ii}\}_{i\ge 1}$ identically distributed and $\{Y_{ij}\}_{1\le i<j}$ identically distributed.  Suppose that $r_k = \max\{\bE(|Y_{11}|^k),\bE(|Y_{12}|^k)\} <\infty$ for each $k\in\bN$.  Suppose further than $\bE(Y_{ij})=0$ for all $i,j$ and set $t=\bE(Y_{12}^2)$.  If $i>j$, define $Y_{ij} \equiv Y_{ji}$, and let $\mathbf{Y}_n$ be the $n\times n$ matrix with $[\mathbf{Y}_n]_{ij} = Y_{ij}$ for $1\le i,j\le n$.  Let $\mathbf{X}_n = n^{-1/2}\mathbf{Y}_n$ be the corresponding Wigner matrix.  Then
\[
\lim_{n\to\infty} \frac{1}{n}\bE\Tr(\mathbf{X}_n^k) = \begin{cases}
  t^{k/2}C_{k/2}, & k\text{ even} \\
  0, & k\text{ odd}
\end{cases}.
\]
\end{proposition}

\begin{proof}
\notready
Proof
\end{proof}

%\iffalse


% 4.2
% lemma (lemma1): using Matrix.mul_apply?? + induction?


% definition of trace
% linearity of expectation --> map_expect????
% lemma1
% defn of Y_i, [n].


% define a graph (no idea how to do this in lean)

% matrices commutative? don't really understand this part of the proof

%define \omega ({i, j})
% 4.3's statement

% 4.4: true because multiplication is commutative (EReal.mul_comm)


% more graph definitions (idk how lean would work)


% smt smt get to 4.5

% 4.6: use 4.5, scalar multiple of expectatio (Finset.smul_expect), trace of scalar multiple (Matrix.trace_smul)


% lemma 4.3: lots more work needed

%4.7: use lemma 4.3

% w >= 2 stuff
% 4.8

% 4.3.1: maybe SimpleGraph.IsTree.card_edgeFinset??

% test edit by Richard
%% test edit 2 by Richard

%\fi




\begin{proposition}%[Exercise 4.3.1 in \cite{Kemp2013RMTNotes}]
  \label{prop:4_3_1}
  \notready
  %\uses{}
  Let $G=(V,E)$ be a connected finite graph. Show that $|G|=\#V\le \#E+1$, and that $|G|=\#V=\#E+1$ if and only if $G$ is a plane tree.
\end{proposition}

\begin{proof}
  \notready
  $|G|= \#V\le \#E+1$: proof by induction on $\#V$. Base case $\#V = 1$ is obvious. For each additional vertex, the number of edges must increase by at least one for the graph to remain connected.

  $|G|=\#V=\#E+1$ if $G$ is a plane tree is already in Lean: SimpleGraph.IsTree.card_edgeFinset.

  $G$ is a plane tree if $|G|=\#V=\#E+1$: proof by induction on $\#V$. Base case $\#V = 1$ is obvious. For each additional vertex, suppose there is a loop. Then, removing some edge reduces the numb
\end{proof}


\begin{lemma}
  \label{lemma:vertex_bound}
  \notready
  \uses{prop:4_3_1}
  For any graph $G = (V, E)$ appearing in the sum in Equation 4.8, $|G| \le k/2 + 1$.
\end{lemma}

\begin{proof}
  \notready
  Proof
\end{proof}



\begin{lemma}
  \label{lemma:factorial_product}
  \notready
  %\uses{}
  The product $n(n-1)\cdots (n-|G|+1)$ is asymptotically equal to $n^{|G|}$.

\end{lemma}

\begin{proof}
  \notready
  Use Nat.ascFactorial_eq_div.
\end{proof}



\begin{lemma}
  \label{lemma:bounded_map}
  \notready
  \uses{lemma:factorial_product}
  The sequence $n\mapsto \frac1n\E\Tr(\mx{X}_n^k)$ is bounded.
\end{lemma}

\begin{proof}
  \notready
  Proof
\end{proof}



\begin{proposition}
  \label{prop:odd_case}
  \notready
  \uses{lemma:vertex_bound}
  Suppose $k$ odd. Then, $\lim_{n\to\infty} \E\Tr(\mx{X}_n^k) = 0$.
\end{proposition}

\begin{proof}
  \notready
  Since $|G|\le \#E+1 \le k/2+1$ and $|G|$ is an integer, it follows that $|G|\le (k-1)/2+1 = k/2 + 1/2$.  Hence, in this case, all the terms in the (finite $n$-independent) sum in Equation \ref{eq EX graphs 2} are $O(n^{-1/2})$
\end{proof}



\begin{proposition}%[Proposition 4.4 in \cite{Kemp2013RMTNotes}]
  \label{prop:4_4}
  \notready
  %\uses{def:}
  Let $(G,w)\in\mathcal{G}_k$ with $w\ge 2$.
  \begin{itemize}
  \item[(a)] If there exists a self-edge $e\in E_s$ in $G$, then $|G|\le k/2$.
  \item[(b)] If there exists an edge $e$ in $G$ with $w(e)\ge 3$, then $|G|\le k/2$.
  \end{itemize}
\end{proposition}

\begin{proof}
  \notready
  \begin{itemize}
    \item[(a)] Since the graph $G = (V,E)$ contains a loop, it is not a tree; it follows from Exercise \ref{ex V < E+1} that $\#V < \#E+1$.  But $w\ge 2$ implies that $\#E\le k/2$, and so $\#V < k/2+1$, and so $|G| = \#V \le k/2$.

    \item[(b)] The sum of $w$ over all edges $E$ in $G$ is $k$.  Hence, the sum of $w$ over $E\setminus\{e\}$ is $\le k-3$.  Since $w\ge 2$, this means that the number of edges excepting $e$ is $\le (k-3)/2$; hence, $\#E \le (k-3)/2+1 = (k-1)/2$.  By the result of Exercise \ref{ex V < E+1}, this means that $\#V \le (k-1)/2+1 = (k+1)/2$.  Since $k$ is even, it follows that $|G|=\#V \le k/2$.
  \end{itemize}
\end{proof}




\begin{definition}
  \label{def:special_set_g}
  \notready
  %\uses{def:}
  Let $\mathcal{G}^{k/2+1}_k$ to be the set of pairs $(G,w)\in\mathcal{G}_k$ where $G$ has $k/2+1$ vertices, contains no self-edges, and the walk $w$ crosses every edge exactly $2$ times.
\end{definition}


\begin{definition}
  \label{def:big_o_with_base}
  \notready
  %\uses{def:}
  Something is $O_k(n^{-1})$ if it is $\le B_k/n$ for some $n$-independent constant $B_k$
\end{definition}

\begin{proposition}[Equation 4.7 in \cite{Kemp2013RMTNotes}]
  \label{prop:eqn_4_7}
  \notready
  \uses{def:big_o_with_base, prop:4_4} %also eqn 4.6
  $\frac1n\E\Tr(\mx{X}_n^k) = \sum_{(G,w)\in\mathcal{G}^{k/2+1}_k} \Pi(G,w) \cdot \frac{n(n-1)\cdots(n-|G|+1)}{n^{k/2+1}} + O_k(n^{-1})$
\end{proposition}

\begin{proof}
  \notready
  Proof
\end{proof}




\begin{proposition}
  \label{prop:4_7_5}
  \notready
  \uses{lemma:vertex_bound, lemma:factorial_product}
  $\lim_{n\to\infty}\E\Tr(\mx{X}_n^k) = \sum_{(G,w)\in\mathcal{G}^{k/2+1}_k} \Pi(G,w)$
\end{proposition}

\begin{proof}
  \notready
  Proof: use the fact that $|G|=k/2+1$ and $n(n-1)\cdots(n-k/2+1) \sim n^{k/2+1}$.
\end{proof}




\begin{proposition}[Equation 4.8 in \cite{Kemp2013RMTNotes}]
  \label{prop:eqn_4_8}
  \notready
  \uses{prop:4_4, prop:4_3_1}
  $\Pi(G,w) = \prod_{e_c\in E^c} \E(Y_{12}^{w(e_c)}) = \prod_{e_c\in E^c} \E(Y_{12}^2) = t^{\#E} = t^{k/2}$.
\end{proposition}

\begin{proof}
  \notready
  Let $(G,w)\in\mathcal{G}^{k/2+1}_k$.  Since $w$ traverses each edge exactly twice, the number of edges in $G$ is $k/2$.  Since the number of vertices is $k/2+1$, Exercise (Prop) 4.3.1 shows that $G$ is a tree.  In particular there are no self-edges (as we saw already in Proposition 4.4)
\end{proof}




\begin{proposition}%[Proposition 4.1 in \cite{Kemp2013RMTNotes}]
  \label{}
  \notready
  \uses{prop:4_7_5, prop:eqn_4_8}
  $\lim_{n\to\infty} \E\Tr(\mx{X}_n^k) = t^{k/2}\cdot\#\mathcal{G}_k^{k/2+1}$
\end{proposition}

\begin{proof}
  \notready
  Proof: 4.7.5 and 4.8.
\end{proof}
